---
title: "Untitled"
output: md_document
---

Hi Ben.

Following your answer on [Stackoverflow](http://stackoverflow.com/questions/39718754/fixing-variance-values-in-lme4), I tried to fix parameter as you described.

```{r}
library(lme4)

rm(list = ls())

set.seed(101)
ss <- sleepstudy[sample(nrow(sleepstudy),size=round(0.9*nrow(sleepstudy))),]

m1 <- lmer(Reaction ~ Days + (1 | Subject) + (0 + Days | Subject), ss)

summary(m1)

```

This model gives me the following estimates on fixed effects:

```{r}
coef(summary(m1))
```

To test your answer, I tried to fix the estimated variances of `m1`. Doing this, I was expecting to find exactly the same estimates on the fixed effects.

```{r}
dd <- as.function(m1)

# These values are those originally estimated
ff <- dd(c(sqrt(703.38),sqrt(35.34)))
```

Now, let's compare original estimates with the new ones.

```{r}
coef(summary(m1))
environment(dd)$pp$beta(1)  ## new parameters
```

As we can see, these are slightly different. What I am missing?

Thank you for your help,
Philippe
